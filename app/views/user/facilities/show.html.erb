<div class='container'>
  <h1>施設詳細</h1>
  <div class='row'>
    <div class='col-md-4'>
      <% if @facility.facility_photos.attached? %>
        <%= image_tag @facility.facility_photos[0], size: '250x150' %>
      <% else %>
        <%= image_tag 'no_image', size: "250x150" %>
      <% end %>
      <div id="map"></div>
    </div>
    <div class='col-md-6'>
      <table class="table">
        <tr>
          <td>施設名</td>
          <td><%= @facility.name %></td>
        </tr>
        <tr>
          <td>施設説明</td>
          <td><%= @facility.content %></td>
        </tr>
        <tr>
          <td>緯度</td>
          <td><%= @facility.latitude %></td>
        </tr>
        <tr>
          <td>経度</td>
          <td><%= @facility.longitude %></td>
        </tr>
      </table>
    </div>
  </div>
</div>
<% if @facility.user == current_user %>
  <td id="favorite_buttons_<%= @facility.id %>" >
    <%= render "user/favorites/btn", facility: @facility %>
  </td>
  <div class='text-center'>
    <%= link_to "編集する", edit_user_facility_path, class: 'btn btn-success' %>
  </div>
  <div class='text-center'>
    <%= link_to '削除する', user_facility_path, method: :delete, data: { confirm: '本当に削除しますか？' }, class: "btn btn-sm btn-danger"%>
  </div>
<% else %>
  <div></div>
  <div></div>
<% end %>
<div class='text-center'>
  <%= link_to "投稿する", new_user_facility_post_path(@facility), class: 'btn btn-success' %>
</div>
<div id="map"></div>

<% if @map.present? %>
<script>
 if (typeof map == "undefined") {
   let map
   let marker
 }

 function initMap(){
   geocoder = new google.maps.Geocoder()

   map = new google.maps.Map(document.getElementById('map'), {
     center: { lat: <%= @map.latitude %>, lng: <%= @map.longitude %> },
     zoom: 10,
   });

   marker = new google.maps.Marker({
     position:  { lat: <%= @map.latitude %>, lng: <%= @map.longitude %> },
     map: map
   });
 }
 </script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['API_KEY'] %>&callback=initMap" async defer></script>
<% end %>